# syntax=docker/dockerfile:1.7
# Dev image with everything needed for Vite hot reload
FROM node:20-alpine

ENV NODE_ENV=development \
    CHOKIDAR_USEPOLLING=1 \
    WATCHPACK_POLLING=true \
    VITE_API_URL=http://localhost:8000

WORKDIR /app

# Install dependencies first so we can mount source code later without rebuilding the layer
COPY package.json package-lock.json* .npmrc* ./
RUN npm install

# Expose Vite dev server port
EXPOSE 5173

# By default we rely on docker compose bind-mounting the source tree, so we only copy configs if needed.
# When the container starts, Vite watches /app for changes and serves on 0.0.0.0
CMD ["npm", "run", "dev", "--", "--host", "0.0.0.0", "--port", "5173"]
